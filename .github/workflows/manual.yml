name: Manual workflow

on:
  workflow_dispatch:

jobs:
  xcode-simulators:
    strategy:
      fail-fast: false
      matrix:
        os: [ macos-14, macos-14-xlarge, macos-15-large, macos-15-xlarge ]
        xcode: [ 15.4, 16.1, 16.2 ]
            
    runs-on: ${{ matrix.os }}

    steps:
      - name: Check if macOSX.sdk exists
        run: |
          if [ -d "$(xcrun --sdk macosx --show-sdk-path)" ]; then
            echo "✅ macOSX.sdk is available"
          else
            echo "❌ macOSX.sdk is missing"
            exit 1
          fi
    
      - uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: ${{ matrix.xcode }}

      - name: Show Xcodebuild version
        run: xcodebuild -version

      - name: Check if macOSX.sdk for selected Xcode ${{ matrix.xcode }} exists
        run: |
          if [ -d "$(xcrun --sdk macosx --show-sdk-path)" ]; then
            echo "✅ macOSX.sdk is available"
          else
            echo "❌ macOSX.sdk is missing"
            exit 1
          fi

      - name: List available SDKs
        run: xcodebuild -showsdks

      - name: List selected SDK
        run: xcrun --show-sdk-version

      - name: List installed simulators & runtimes
        run: xcrun simctl list
