name: Manual workflow

on:
  workflow_dispatch:

jobs:
  xcode-simulators:
    strategy:
      matrix:
        include:
          - os: macos-15-large-canary
            xcode_versions: 26_beta_5
            
    runs-on: ${{ matrix.os }}

    steps:
      - name: Select Xcode
        run: |
            sudo xcode-select -s "/Applications/Xcode_${{ matrix.xcode_versions }}.app"

      - name: List SDKs
        run: |
            xcodebuild -showsdks

      - name: List runtimes
        run: |
            xcrun simctl list runtimes

      - name: List devices
        run: |
            xcrun simctl list devices
            
      - name: Check iOS device
        run: |
            SIMULATOR_UDID="62DAAC6A-D81B-4EF4-BFFC-5FE09AF6EFD0"
            echo "üîπ Booting simulator $SIMULATOR_UDID..."
            xcrun simctl boot "$SIMULATOR_UDID" || true
            echo -n "‚è≥ Waiting for simulator to boot"
            while true; do
                STATE=$(xcrun simctl list devices | grep "$SIMULATOR_UDID" | awk -F'[()]' '{print $3}' | xargs)
                if [[ "$STATE" == "Booted" ]]; then
                    echo " ‚úÖ Booted"
                    break
                fi
                echo -n "."
                sleep 1
            done
            sleep 2  # –ø—Ä–∏–º–µ—Ä –ø–∞—É–∑—ã
            echo "üîπ Shutting down simulator $SIMULATOR_UDID..."
            xcrun simctl shutdown "$SIMULATOR_UDID"
